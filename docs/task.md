# Система мониторинга
Разработка высоконагруженной масштабируемой информационно-аналитической системы балансировки нагрузки сервисов на основе технологии обратного прокси с возможностью управления и мониторинга через веб-интерфейс.

## Стек
Стек: Docker, Go (Chi), JWT, PostgreSQL, React (vite react-swc-ts), NGINX

## Диаграмма взаимодействия с системой
Веб-интерфейс -> Основной узел <-> Узел 1
                               <-> Узел 2
                               ...
1. Пользователь меняет настройки или запрашивает информацию об узле
2. Основной узел меняет настройки или делает нужные запросы к узлам
3. Узел меняет настройки или возвращает информацию
4. Основной узел возвращает информацию пользователю

## Диаграмма взаимодействия с сервисами
Пользователь <-> Основной узел <-> Узел 1 <-> Контейнер 1
                                          <-> Контейнер 2
                                          ...
                               <-> Узел 2 <-> Контейнер 1
                                          <-> Контейнер 2
                                          ...
                               ...
1. Пользователь запрашивает страницу или информацию у сервиса
2. Запрос передается на узел
3. Узел передает запрос на контейнер
4. Контейнер возвращает информацию
5. Узел возвращает информацию пользователю

## Модули системы
Информационно-аналитическая система предполагает реализацию следующих компонентов:
1. модуль конфигурирования балансировщика нагрузки и динамического изменения параметров прокси-сервера в режиме реального времени без прерывания доступа пользователей к сервисам;
2. модуль автоматизированного управления репликацией контейнерных экземпляров сервисов на основе анализа трафика;
3. модуль управления DNS-записями сервисов (под DNS записями подразумеваются внутренние DNS записи для обратного проксирования, например, если запрос идет на foo.example.com через основной узел, то запрос пойдет на узел 1, а если на bar.example.com, то на узел 2);
4. модуль автоматизации получения и обновления SSL-сертификатов через сервис Let’s Encrypt (с помощью запуска Docker контейнера neilpang/acme.sh с нужными параметрами);
5. модуль создания шаблонов веб-страниц и управления их отображением на основе анализа HTTP-статусов ответных сообщений сервисов;
6. модуль анализа сетевого трафика с применением алгоритмов выявления аномального поведения источников запросов и их последующей изоляции;
7. модуль мониторинга и аналитики собранных метрик производительности хостовых систем, контейнеров, виртуальных машин и кастомных показателей сервисов;
8. модуль централизованной обработки уведомлений с возможностью кастомизации шаблонов оповещений (нотификация должна происходить в Телеграм Бота);
9. модуль получения и визуализации текущих лог-сообщений контейнеров и сервисов (docker logs).

Я вижу это все так: при создании дочернего узла, создается ключ доступа, дочерний узел каждую секунду присылает требуемую информацию, а в ответ получает действия, необходимые для совершения. Основной узел отвечает за нотификацию, показ пользователю информации и ответу дочерним узлам с действиями, которые сделал пользователь.

Дочерний узел должен запускаться из Docker, но должна быть возможность видеть системные показатели, а не только показатели в рамках контейнера.

Не использовать ничего, кроме REST API (ни gRPC, ни WebSocket). Не должна быть зависимость от сервисов, таких как: Prometheus, node-exporter, cAdvisor, Promtail, Loki.

В корне проекта 2 папки: core (основной узел) и agent (дочерний узел).

Core: папки app (фронтенд) и server (бэкенд), docker-compose.yml (services: app, server, nginx - основной роутер, в котором есть основной сервер: если идет по /api, то идет на бэкенд, а все остальное на фронтенд, а также есть пользовательские сервера, которые перенаправляются на дочерние узлы), .env, остальные файлы
Agent: docker-compose.yml (services: agent, nginx - настраиваемый пользователем роутер, который перенаправляет трафик в соответствующий контейнер в зависимости от домена), Dockerfile, .env (помимо прочих переменные есть ID и KEY), остальные файлы